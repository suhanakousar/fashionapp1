# AUTO-GENERATED BY KIRO
# Dataset Integration Guide

## Overview

The fusion system now integrates two powerful fashion datasets:

1. **Dress Code Dataset** - For human parsing and garment segmentation
2. **FashionPedia API** - For category detection and attribute extraction

## Dress Code Integration

### Purpose
- Human parsing with 18 classes (background, hat, hair, upper_clothes, skirt, pants, dress, etc.)
- Garment region segmentation (top, bottom, full dress)
- Keypoint extraction for pose estimation
- Dense pose for better drape mapping

### Usage
```typescript
import { extractGarmentRegions, mapDressCodeLabelsToRegions } from "./models/dresscode";

// Extract garment regions from mannequin image
const segmentation = await extractGarmentRegions(mannequinUrl, "lehenga");
// Returns: { topMask, bottomMask, dressMask, humanLabelMap, keypoints }
```

### Integration Points
- **Garment Segmentation**: Used in `segmentGarmentRegions()` in `fusionPipeline.ts`
- **Region Mapping**: Maps Dress Code labels (4=upper_clothes, 5=skirt, 6=pants, 7=dress) to our regions
- **Training Data**: Can be used to prepare training pairs for LoRA fine-tuning

## FashionPedia Integration

### Purpose
- Category detection (27 main categories)
- Attribute extraction (294 fine-grained attributes)
- Pattern recognition (paisley, floral, geometric, etc.)
- Material detection (silk, chiffon, denim, etc.)
- Silhouette, neckline, sleeve type detection

### Usage
```typescript
import { analyzeWithFashionPedia, getGarmentParts } from "./models/fashionpedia";

// Analyze fabric image
const analysis = await analyzeWithFashionPedia(fabricUrl);
// Returns: { category, attributes: { patterns, materials, silhouette, neckline, sleeve } }

// Get garment parts segmentation
const parts = await getGarmentParts(imageUrl, "lehenga");
// Returns: [{ part: "blouse", mask: "..." }, { part: "skirt", mask: "..." }]
```

### Integration Points
- **Pattern Extraction**: Used in `extractPattern()` for better pattern detection
- **Feature Extraction**: Used in `extractFabricFeatures()` for attribute detection
- **Category Mapping**: Maps FashionPedia categories to our category system

## Benefits

1. **Better Segmentation**: Dress Code provides accurate human parsing for garment regions
2. **Enhanced Attributes**: FashionPedia detects patterns, materials, silhouettes automatically
3. **Training Data**: Both datasets can be used for LoRA fine-tuning
4. **Category Detection**: Automatic category detection from uploaded images
5. **Part Segmentation**: Identify garment parts (sleeves, collars, pockets, etc.)

## Implementation Status

### Current (Mock)
- Basic integration structure in place
- Mock responses for development
- Category and attribute mapping defined

### TODO (Production)
1. **Dress Code Model Integration**:
   - Load SCHP human parsing model
   - Integrate OpenPose for keypoints
   - Generate actual segmentation masks

2. **FashionPedia API Integration**:
   - Set up FashionPedia API endpoint
   - Load Attribute-Mask R-CNN model
   - Implement actual attribute detection

3. **Training Pipeline**:
   - Use Dress Code for training data preparation
   - Use FashionPedia attributes for prompt generation
   - Fine-tune LoRA with dataset annotations

## Dataset Files

- `datasets/dress-code-main/` - Dress Code dataset structure
- `datasets/fashionpedia-api-master/` - FashionPedia API and examples

## References

- Dress Code: https://github.com/aimagelab/dress-code
- FashionPedia: https://fashionpedia.github.io/home/index.html

